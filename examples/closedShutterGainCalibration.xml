<container>

<!-- Closed Shutter Data: -->
<!-- <property name="data" value="/local/data/kgray/test/20131002_045.fits.gz" /> 
<property name="dataDRS" value="/local/data/kgray/test/20131002_040.drs.fits.gz" /> -->

<property name="data" value="/home/fabian/mount/Phido/fhgfs_app/fact/raw/2013/10/02/20131002_045.fits.gz" /> 
<property name="dataDRS" value="/home/fabian/mount/Phido/fhgfs_app/fact/raw/2013/10/02/20131002_040.drs.fits.gz" />
<property name="closedGainOutFile" value="/home/fabian/mount/data/LinuxDaten/uni/FACT/gainStudy/closedShutterGain.txt" /> 

<!-- Open Shutter Data: -->
<!-- <property name="data" value="/local/data/kgray/test/20130104_095.fits.gz" />  -->
<!-- <property name="dataDRS" value="/local/data/kgray/test/20130104_076.drs.fits.gz" /> -->


    <stream id="fact" class="fact.io.FitsStream" 
            url="file:${data}" />
            
        <process input="fact">
        
        <fact.utils.PreviousEventInfo startCellKey="StartCellData" outputKey="prevEvents" limitEvents="10"/>
        
        <fact.filter.DrsCalibration url="file:${dataDRS}" key="Data"  outputKey="DataCalibrated" />  
        <fact.datacorrection.PatchJumpRemoval dataKey="DataCalibrated" outputKey="DataCalibrated" prevEventsKey="prevEvents" startCellKey="StartCellData" jumpLimit="2.0" />
        <fact.datacorrection.RemoveSpikes dataKey="DataCalibrated" outputKey="DataCalibrated" startCellKey="StartCellData" leftBorder="6" spikeLimit="20" topSlopeLimit="16" maxSpikeLength="4"/>
        <fact.datacorrection.InterpolateBadPixel key="DataCalibrated"  outputKey="DataCalibrated" badChidIds="863,868,297,927,80,873,1093,1094,527,528,721,722" />
               
        <fact.filter.MovingAverage key="DataCalibrated" outputKey="DataSmoothed" length="5" />

<!--  For Closed Shutter Data: Threshold Extraction Method -->            
        <fact.features.FindThresholdCrossings key="DataSmoothed" outputKey="StartPositions" visualizeOutputKey="PositionPulseCandidates" minBelow="4" minAbove="9" threshold="5.0" />
        <fact.features.PulseMaxAmplitude key="DataSmoothed" outputKey="PulseMaxAmp" pulsePositionKey="StartPositions" />
        <fact.features.ArrivalTime key="DataSmoothed" outputKey="ArrivalTimesAmp" maxAmpPositionKey="PulseMaxAmp" visualizeKey="halfMaxArrivalTimes"/>
        <fact.features.PulseSizeCalculator key="DataSmoothed" outputKey="ClosedPulseSizesAmp" arrivalTimeKey="ArrivalTimesAmp" width="30" />


<!--  For Open Shutter Data: Slope Extraction Method -->
		<!-- <fact.features.Derivation key="DataSmoothed" outputKey="slopeKey" />
		<fact.features.ArrivalTimeFromSlope key="DataSmoothed" outputKey="ArrivalTimesSlope" derivationKey="slopeKey" visualizeKey="slopeArrivalTimes" 
			baselineKey="baselines" skipFirstSlices="20" skipLastSlices="120"/>
		<fact.features.OpenShutterPulseSize key="DataSmoothed" outputKey="OpenPulseSizesSlope" arrivalTimeKey="ArrivalTimesSlope" baselineKey="baselines" width="30" /> -->
		
		<fact.io.PrintKeysOnConsole keys="TriggerType" /> 
<!--         <fact.io.CreateNestedListFile DataOutputKey="OpenPulseSizesSlope" urlString="file:///net/home.e5.physik.tu-dortmund.de/vol/ph_e5v/e5b/homes/kgray/data/test/file-slope-open-pulses.txt" /> -->
<!--         <fact.io.CreateNestedListFile DataOutputKey="ArrivalTimesSlope" urlString="file:///net/home.e5.physik.tu-dortmund.de/vol/ph_e5v/e5b/homes/kgray/data/test/file-slope-arrivalTimes.txt" /> -->
<!--         <fact.io.CreateNestedListFile DataOutputKey="ArrivalTimesAmp" urlString="file:///net/home.e5.physik.tu-dortmund.de/vol/ph_e5v/e5b/homes/kgray/data/test/file-amp-arrivalTimes.txt" /> -->
        <!-- <fact.io.CreateNestedListFile DataOutputKey="ClosedPulseSizesAmp" urlString="file:${closedGainOutFile}" url="" /> -->
        
   
<!-- 	<fact.ShowViewer key="DataCalibrated"/> -->

	</process>
</container>
