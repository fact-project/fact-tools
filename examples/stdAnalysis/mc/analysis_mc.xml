<container>

    <property name="fhgfs" value="/home/fabian/mount/Phido/fhgfs_app" />
    <property name="config" value="src/main/resources" />
<!--     <property name="fhgfs" value="/fhgfs/groups/app" />
    <property name="config" value="/home/fact_opr/facttools" /> -->

    <property name="infile" value="${fhgfs}/fact/simulated/ceres/test/00000000.000_D_MonteCarlo000_Events.fits.gz" />
    <property name="drsfile" value="${fhgfs}/fact/simulated/drsfiles/12bitADC/offsetMinus1850/test300samples2.drs.fits.gz" />
    <property name="integralGainFile" value="${config}/defaultIntegralGains.csv" />
    <property name="outfile" value="/home/fabian/testoutfile_mc.txt" />
    <!-- <property name="outfile" value="/home/ftemme/testoutfile_mc.txt" /> -->

    <property name="core_threshold" value="7.0" />
    <property name="neighbor_threshold" value="4.5"/>
    <property name="time_limit" value="10.0" />
    <property name="min_number_of_pixel" value="2" />
    <property name="start_search_window" value="35" />
    <property name="range_search_window" value="60" />

    <property name="event_param" 
    	value="@source,EventNum" />
    	
    <property name="mc_truth"
        value="MCorsikaEvtHeader.fTotalEnergy,CorsikaEvtHeader.fFirstInteractionHeight,MCorsikaEvtHeader.fMomentumX,MCorsikaEvtHeader.fMomentumY,MCorsikaEvtHeader.fMomentumZ,MCorsikaEvtHeader.fZd,MCorsikaEvtHeader.fAz,MCorsikaEvtHeader.fX,MCorsikaEvtHeader.fY,MCorsikaEvtHeader.fWeightedNumPhotons,MMcEvt.fEvtNumber,MMcEvt.fThick0,MMcEvt.fPhotElfromShower,MMcEvt.fEventReuse"/>

    <property name="stat_allPix_param"
        value="photonchargeMean,arrivalTimeMean" />
    <property name="stat_phCharge_param"
        value="phChargeShower_mean,phChargeShower_max,phChargeShower_min,phChargeShower_kurtosis,phChargeShower_variance,phChargeShower_skewness" />
    <property name="stat_arrTime_param"
        value="arrTimeShower_mean,arrTimeShower_max,arrTimeShower_min,arrTimeShower_kurtosis,arrTimeShower_variance,arrTimeShower_skewness" />
    <property name="stat_maxSlopes_param"
        value="maxSlopesShower_mean,maxSlopesShower_max,maxSlopesShower_min,maxSlopesShower_kurtosis,maxSlopesShower_variance,maxSlopesShower_skewness" />
    <property name="stat_arrTimePos_param"
        value="arrTimePosShower_mean,arrTimePosShower_max,arrTimePosShower_min,arrTimePosShower_kurtosis,arrTimePosShower_variance,arrTimePosShower_skewness" />
    <property name="stat_maxSlopesPos_param"
        value="maxSlopesPosShower_mean,maxSlopesPosShower_max,maxSlopesPosShower_min,maxSlopesPosShower_kurtosis,maxSlopesPosShower_variance,maxSlopesPosShower_skewness" />
    <property name="stat_maxPos_param"
        value="maxPosShower_mean,maxPosShower_max,maxPosShower_min,maxPosShower_kurtosis,maxPosShower_variance,maxPosShower_skewness" />
    <property name="stat_phChargeSat_param"
        value="phChargeSaturation_mean,phChargeSaturation_max,phChargeSaturation_min,phChargeSaturation_kurtosis,phChargeSaturation_variance,phChargeSaturation_skewness" />
    <property name="stat_arrTimeTOT_param"
        value="arrTimeSaturation_mean,arrTimeSaturation_max,arrTimeSaturation_min,arrTimeSaturation_kurtosis,arrTimeSaturation_variance,arrTimeSaturation_skewness" />

    <property name="shower_param"
        value="numPixelInShower,Size,Length,Width,numIslands,Delta,COGx,COGy,m3l,m3t,M3Long,M3Trans,M4Long,M4Trans,Disp" />
    <property name="conc_param"
        value="Concentration_onePixel,Concentration_twoPixel,ConcCore,concCOG,Leakage,Leakage2" />
    <property name="spread_param"
        value="Slope_long,Slope_trans,Slope_spread,Slope_spread_weighted,Timespread,Timespread_weighted" />
    <property name="time_gradient_param"
        value="timeGradientSlope,timeGradientSlope_err,timeGradientIntercept,timeGradientIntercept_err,timeGradientSSE" />

    <property name="sourcePos"
        value="sourcePosition,antiSourcePosition_1,antiSourcePosition_2,antiSourcePosition_3,antiSourcePosition_4,antiSourcePosition_5" />
    <property name="alpha"
        value="Alpha,Alpha_Off_1,Alpha_Off_2,Alpha_Off_3,Alpha_Off_4,Alpha_Off_5" />
    <property name="distance"
        value="Distance,Distance_Off_1,Distance_Off_2,Distance_Off_3,Distance_Off_4,Distance_Off_5" />
    <property name="cosdeltaalpha"
        value="CosDeltaAlpha,CosDeltaAlpha_Off_1,CosDeltaAlpha_Off_2,CosDeltaAlpha_Off_3,CosDeltaAlpha_Off_4,CosDeltaAlpha_Off_5" />
    <property name="theta"
        value="Theta,Theta_Off_1,Theta_Off_2,Theta_Off_3,Theta_Off_4,Theta_Off_5,Theta_recPos,Theta_Off_1_recPos,Theta_Off_2_recPos,Theta_Off_3_recPos,Theta_Off_4_recPos,Theta_Off_5_recPos" />

    <property name="keysForOutput"
        value="${event_param},${mc_truth},${stat_allPix_param},${stat_phCharge_param},${stat_arrTime_param},${stat_maxSlopes_param},${stat_arrTimePos_param},${stat_maxSlopesPos_param},${stat_maxPos_param},${stat_phChargeSat_param},${stat_arrTimeTOT_param},${shower_param},${conc_param},${spread_param},${time_gradient_param},${sourcePos},${alpha},${distance},${cosdeltaalpha},${theta}" />

    <stream id="fact" class="fact.io.FitsStream"  url="file:${infile}"/>

    <process id="2" input="fact">
    
		<stream.flow.Skip condition="%{data.TriggerType} != 4" />
        <!-- Calibration: -->
        <!-- PreviousEventInfo, DrsCalibration, PatchJumpRemoval, RemoveSpikes,
        DrsTimeCalibration, ArrayTimeCorrection, InterpolateBadPixel -->
        <include file="examples/stdAnalysis/mc/calibration_mc.xml" />
        <!-- Output: DataCalibrated -->

        <!-- Extraction -->
        <!-- BasicExtraction, RisingEdgeForPositions, RisingEdgePolynomFit, TimeOverThreshold,
        PhotonChargeTimeOverThreshold, HandleSaturation, CorrectPixelDelays-->
        <include file="examples/stdAnalysis/mc/extraction_mc.xml" />     
        <!-- Output: photoncharge, arrivalTime -->   

        <!-- Cleaning -->
        <!-- SourcePosition(Cetatauri), CoreNeighborCleanTimeNeighbor-->
        <include file="examples/stdAnalysis/mc/cleaning_mc.xml" />     
        <!-- Output: shower -->   
        
        <!-- Parameter calculation (only source independent) -->
        <!-- ArrayMean(photoncharge,arrivalTime), ArrayStatistics(photoncharge,arrivalTime,maxSlopes,
        arrivalTimePos,maxSlopesPos,maxAmplitudePosition,photonchargeSaturated,arrivalTimeTOT), 
        Size, DistributionFromShower, M3Long, Length, Width, NumberOfIslands, TimeGraident,
        Concentration, ConcentrationCore, ConcentrationAtCenterOfGravity, Leakage, TimeSpread,
        ShowerSlope, Disp -->
        <include file="examples/stdAnalysis/mc/parameterCalc_mc.xml" /> 
        <!-- Output: source independent parameters -->   

        <!-- Parameter calculation (only source dependent) -->
        <!-- SourcePosition(${sourcename}), AntiSourcePosition(5), Alpha(for 6 Sources),
        Distance(for 6 Sources), CosDeltaAlpha(for 6 Sources), Theta(for 6 Sources) -->
        <include file="examples/stdAnalysis/mc/sourceParameter_mc.xml" /> 
        <!-- Output: source dependent parameters -->
        
        <!-- <fact.io.PrintKeysOnConsole keys="${keysForOutput}" /> -->

        <fact.io.RootASCIIWriter url="file:${outfile}" keys="${keysForOutput}" />

    </process>


</container>
