<container>

	<properties url="classpath:/default/settings.properties" />

    <property name="fhgfs" value="/home/fabian/mount/Phido/fhgfs_app" />
    
    <property name="infile" value="${fhgfs}/fact/raw/2013/09/29/20130929_179.fits.gz" />
    <property name="drsfile" value="${fhgfs}/fact/raw/2013/09/29/20130929_167.drs.fits.gz" />
    <property name="drivefile" value="${fhgfs}/fact/aux/2013/09/29/20130929.DRIVE_CONTROL_TRACKING_POSITION.fits" />
        
    <property name="integralGainFile" value="classpath:/default/gain_sorted_20131127.csv" />
    <property name="pixelDelayFile" value="classpath:/default/delays_20141114.csv" />
    
    <property name="outfile" value="/home/fabian/testoutfile.txt" />


    <stream id="fact" class="fact.io.FitsStream"  url="file:${infile}"/>

    <process id="2" input="fact">
    	<!-- prevEventAndSkip: -->
        <!-- PreviousEventInfo, Skip(no Data Trigger) -->
        <include url="classpath:/default/data/prevEventAndSkip.xml" />
        <!-- Output: Data -->
    
        <!-- Calibration: -->
        <!-- DrsCalibration, PatchJumpRemoval, RemoveSpikes,
        DrsTimeCalibration, ArrayTimeCorrection, InterpolateBadPixel -->
        <include url="classpath:/default/data/calibration.xml" />
        <!-- Output: DataCalibrated -->

        <!-- Extraction -->
        <!-- BasicExtraction, RisingEdgeForPositions, RisingEdgePolynomFit, TimeOverThreshold,
        PhotonChargeTimeOverThreshold, HandleSaturation, CorrectPixelDelays-->
        <include url="classpath:/default/data/extraction.xml" />     
        <!-- Output: photoncharge, arrivalTime -->   

        <!-- Cleaning -->
        <!-- SourcePosition(Cetatauri), CoreNeighborCleanTimeNeighbor-->
        <include url="classpath:/default/data/cleaning.xml" />     
        <!-- Output: shower -->   
        
        <!-- Parameter calculation (only source independent) -->
        <!-- ArrayMean(photoncharge,arrivalTime), ArrayStatistics(photoncharge,arrivalTime,maxSlopes,
        arrivalTimePos,maxSlopesPos,maxAmplitudePosition,photonchargeSaturated,arrivalTimeTOT), 
        Size, DistributionFromShower, M3Long, Length, Width, NumberOfIslands, TimeGraident,
        Concentration, ConcentrationCore, ConcentrationAtCenterOfGravity, Leakage, TimeSpread,
        ShowerSlope, Disp -->
        <include url="classpath:/default/data/parameterCalc.xml" /> 
        <!-- Output: source independent parameters -->   

        <!-- Parameter calculation (only source dependent) -->
        <!-- SourcePosition(${sourcename}), AntiSourcePosition(5), Alpha(for 6 Sources),
        Distance(for 6 Sources), CosDeltaAlpha(for 6 Sources), Theta(for 6 Sources) -->
        <include url="classpath:/default/data/sourceParameter.xml" /> 
        <!-- Output: source dependent parameters -->
        
        <!-- <fact.io.PrintKeysOnConsole keys="${keysForOutput}" /> -->

        <fact.io.RootASCIIWriter url="file:${outfile}" keys="${keysForOutput}" />

    </process>


</container>
