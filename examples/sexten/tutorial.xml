<container>

    <properties url="classpath:/default/settings.properties" />

    <!-- Pathes to the input files -->
    <property name="infile" value="file:/home/maxnoe/fact-tools/20140623_124.fits.fz" />
    <property name="drsfile" value="file:/home/maxnoe/fact-tools/20140623_102.drs.fits.gz" />

    <!-- Name of the stream and url to the input file -->
    <stream id="fact" class="fact.io.zfits.ZFitsStream"  url="${infile}" />

    <!-- Description of the process and the corresponding stream -->
    <process id="2" input="fact">
        <fact.utils.PreviousEventInfo
                startCellKey="StartCellData"
                outputKey="prevEvents"
                limitEvents="${prevEvents_limitEvents}"
                />
        <stream.flow.Skip condition="%{data.TriggerType} != 4" />

        <fact.datacorrection.DrsCalibration
                url="${drsfile}"
                key="Data"
                outputKey="DataCalibrated"
        />
        <fact.datacorrection.PatchJumpRemoval
                dataKey="DataCalibrated"
                outputKey="DataCalibrated"
                prevEventsKey="prevEvents"
                startCellKey="StartCellData"
                jumpLimit="${patchJumpRemoval_jumpLimit}"
        />
        <fact.datacorrection.RemoveSpikes
                dataKey="DataCalibrated"
                outputKey="DataCalibrated"
                startCellKey="StartCellData"
                leftBorder="${removeSpikes_leftBorder}"
                spikeLimit="${removeSpikes_spikeLimit}"
                topSlopeLimit="${removeSpikes_topSlopeLimit}"
                maxSpikeLength="${removeSpikes_maxSpikeLength}"
        />

        <fact.tutorial.SimpleArrivalTimeExtraction
            dataKey="DataCalibrated"
            outputKey="ArrivalTime"
        />


        <fact.ShowViewer key="DataCalibrated"/>

    </process>


</container>
