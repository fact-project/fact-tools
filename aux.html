<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8 at 2019-10-17 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20191017" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Fact Tools &#x2013; Handling auxiliary data</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="http://www.uni-dortmund.de/" id="bannerLeft"><img src="images/logo_tu.png"  alt="tu logo"/></a></div>
        <div class="pull-right"><a href="./" id="bannerRight"><img src="images/header-bg-topLeft.png"  alt="ls8 logo"/></a></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2019-10-17<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.1.3</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
            <li class="nav-header">General</li>
    <li><a href="index.html" title="Overview"><span class="none"></span>Overview</a>  </li>
    <li><a href="publications.html" title="Publications"><span class="none"></span>Publications</a>  </li>
    <li><a href="viewer.html" title="Fact Viewer"><span class="none"></span>Fact Viewer</a>  </li>
    <li><a href="build.html" title="Building"><span class="none"></span>Building</a>  </li>
          <li class="nav-header">Tutorial</li>
    <li><a href="tutorial/index.html" title="FACT Tools Tutorial"><span class="icon-chevron-right"></span>FACT Tools Tutorial</a>  </li>
          <li class="nav-header">Documentation</li>
    <li><a href="quickstart.html" title="Quickstart"><span class="none"></span>Quickstart</a>  </li>
    <li><a href="multistream.html" title="Using Multistreams"><span class="none"></span>Using Multistreams</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>Using Auxiliary Data</a>
  </li>
    <li><a href="stdAnalysis/standardAnalysis.html" title="Standard Analysis"><span class="icon-chevron-down"></span>Standard Analysis</a>
      <ul class="nav nav-list">
    <li><a href="stdAnalysis/standardSettings.html" title="Standard Settings"><span class="none"></span>Standard Settings</a>  </li>
      </ul>
  </li>
    <li><a href="examples.html" title="Usage Examples"><span class="icon-chevron-down"></span>Usage Examples</a>
      <ul class="nav nav-list">
    <li><a href="example_writing.html" title="Reading and Writing Data"><span class="none"></span>Reading and Writing Data</a>  </li>
    <li><a href="plotting/example_plots.html" title="Plotting Data"><span class="icon-chevron-right"></span>Plotting Data</a>  </li>
      </ul>
  </li>
    <li><a href="programming_examples/programming_example.html" title="Programming Examples"><span class="icon-chevron-right"></span>Programming Examples</a>  </li>
    <li><a href="resources.html" title="Further Resources"><span class="none"></span>Further Resources</a>  </li>
          <li class="nav-header">Download</li>
    <li><a href="download.html" title="Download"><span class="none"></span>Download</a>  </li>
          <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a>  </li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<div class="section">
<h2><a name="Handling_auxiliary_data"></a>Handling auxiliary data</h2>
<p>Its a common task to use some additional sensor data during your analysis. This means adding more data to your stream from the outside. In case of the FACT telescope this data comes from various sources like weather stations or dust measurements and is written to files during data taking.</p>
<div class="section">
<h3><a name="Reading_Aux_Files"></a>Reading Aux Files</h3>
<p>In case you want to read the data from files you can use a class called AuxFileService. In your .xml you create an AuxService by adding the following line before the <tt>process</tt> tag opens.</p>

<div>
<div>
<pre class="source">    &lt;service id=&quot;horst&quot; class=&quot;fact.auxservice.AuxFileService&quot; auxFolder=&quot;file:/fact/aux/2013/10/12/&quot; /&gt;
</pre></div></div>

<p>The <tt>auxFolder</tt> url has to point to a directory containing the data for <i>one</i> night. The file names of the auxfiles are expected to adhere to the usual naming conventions of the form <tt>YYYYMMDD.SERVICE_NAME.fits</tt></p>
<p>If you want to use the service inside of your processor you simply add the service as a .xml parameter.</p>

<div>
<div>
<pre class="source">    @Parameter(required = false, description = &quot;Name of the service that provides aux files&quot;)
    private AuxiliaryService auxService;
</pre></div></div>

<p>To get a data point from the service you need to specify a timestamp or take the one from the data event you&#x2019;re currently analysing.</p>

<div>
<div>
<pre class="source">    AuxPointStrategy earlier = new Earlier();
    AuxPoint sourcePoint = auxService.getAuxiliaryData(AuxiliaryServiceName.DRIVE_CONTROL_SOURCE_POSITION, timeStamp, earlier);
</pre></div></div>

<p>Since sensor data can be written at different time intervals and frequencies we need to specify some strategy for fetching the data. E.g. get the nearest point written before the given timestamp. For details about strategies which are already implemented check the <a href="apidocs/index.html">JavaDocs</a>.</p>
<p>To get specific data from an AuxPoint you need to know the name of the key your data has in the original auxiliary file. So for example if you want to get the right ascension of your source in the sky you simply call the appropriate method on your AuxPoint</p>

<div>
<div>
<pre class="source">    double ra = sourcePoint.getDouble(&quot;Ra_src&quot;)
</pre></div></div>

<p>And then you call the processor from your .xml like this</p>

<div>
<div>
<pre class="source">    &lt;fact.somePackage.someProcessor auxService=&quot;horst&quot;/&gt;
</pre></div></div>

<p>For some more general information about services and streams read the <a href="./ressources.html">Tech Report</a> by C. Bockermann</p></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2019.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>
